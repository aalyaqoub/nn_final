<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Forgetting or Suppressing</title>
    <meta property="og:title" content=Your Project Name" />
    <meta name="twitter:title" content="Your Project Name" />
    <meta
      name="description"
      content="Your project about your cool topic described right here."
    />
    <meta
      property="og:description"
      content="Your project about your cool topic described right here."
    />
    <meta
      name="twitter:description"
      content="Your project about your cool topic described right here."
    />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- bootstrap for mobile-friendly layout -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
      integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"
    ></script>
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700"
      rel="stylesheet"
    />
    <link href="style.css" rel="stylesheet" />
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-csp.js"
      id="MathJax-script"
      async
    ></script>
  </head>
  <body class="nd-docs">
    <div class="nd-pageheader">
      <div class="container">
        <h1 class="lead">
          <nobr class="widenobr">Forgetting or Suppressing</nobr>
        </h1>
      </div>
    </div>
    <!-- end nd-pageheader -->

    <div class="container">
      <div class="row">
        <div class="col">
          <div class="justify-content-center text-center">
            <h1>An Analysis of "Erasing Concepts from Diffusion Models"</h1>
            <p>By: Ali Alyaqoub and Adam Belfki</p>
            <p>Original Paper Link: <a href="https://erasing.baulab.info">Erasing Concepts from Diffusion Models</a></p>
          </div>
        </div>
        <div>
          <div class="container text-center">
            <img
              src="images/ErasingShowcase.png"
              alt="ErasingShowcase"
              style="width: 700px"
            />
          </div>
          <h2>Introduction</h2>
          <p>
            Significant recent advancements in the field of GenAI have been achieved with 
            Diffusion Models for image generation. Hence, many efforts have been deployed 
            to ensure the generation of appropriate content by avoiding NSFW images 
            and addressing copy-right issues. A number of solutions 
            have been proposed to tackle this problem with different approaches 
            centered around filtering, during either pre-training or post-generation.</p>
          <p>
            In this project we decide to look into a novel method focused on 
            fine-tuning diffusion models using negative guidance as a teacher for 
            the erasure of concepts, which has proven to be more effective than 
            the aforementioned techniques. Most specifically, we are interested in 
            answering the following questions: 
          </p>
          <ul>
            <li>
              Does this method produce different results on different model sizes? And what 
              could be the ramifications of "forgetting" on smaller models? 
            </li>
            <li>
              How does the erasure perform when the fine-tuning operation is conducted using 
              unseen data? Is erasure reliant on generalization?
            </li>
            <li>
              By erasing a concept, is the model completely unlearning it or is it simply 
              being suppressed from being expressed? In either case, how easy is it to relearn 
              an erased concept? Does it require the same original training effort?
            </li>
          </ul>
          <h2>Paper Overview</h2>
          <p>
            The paper at hand proposes a method to remove concepts permanently from a diffusion 
            model which makes it very hard to circumvent even if the user has access to the model 
            weights. Previous methods based on filtering datasets are fundamentally costly and not 
            flexible to problems discovered after training while filtering generated content can 
            have unintended consequences on the output quality. 
          </p>
          <p>
            To address these issues, ESD relies on fine-tuning pre-trained diffusion models to 
            minimize the probability of generating certain images linked to a targeted concept 
            and using no additional data. The fine-tuning process involves using several instances 
            of the model with one set of parameters frozen while training the other set of 
            parameters to erase the concept. Partially de-noised images,  constrained by the 
            concept, are sampled from the training model while inference is performed twice on 
            the frozen  model to predict noise both conditioned and unconditioned on the prompt 
            which combined to negate the predicted noise associated with the targeted concept. 
            This technique modifies the scoring function to move the data distribution to 
            minimize the generation images that can be labeled with the targeted prompt.
          </p>
          <div class="container text-center">
            <img
              src="images/MathOverview.png"
              alt="CompleteMathOveriew"
              style="width: 850px"
            />
          </div>
          <h5>Mathematical reasoning behind erasure:</h5>
          <ul>
            <li>
              <img
                src="images/math/VanNoGeneral.png"
                alt="External Image"
                style="width: 200px"
              />
              represents the predicted noise of Van Gogh with
              general noise
              <img
                src="images/math/VanWithGeneral.png"
                alt="External Image"
                style="width: 90px"
              />
              minus the genreal noise
              <img
                src="images/math/General.png"
                alt="External Image"
                style="width: 70px"
              />
              . <b>This leaves us with the predicted noise of just Van Gogh.</b>
            </li>
            <li>
              <img
                src="images/math/GeneralNoVan.png"
                alt="External Image"
                style="width: 290px"
              />
              represents the general noise
              <img
                src="images/math/General.png"
                alt="External Image"
                style="width: 70px"
              />
              minus the predicted noice of just Van Gogh.
              <b>
                This leaves us with the noise of everything but Van Gogh. This
                is our objective that the model is trying to reach.
              </b>
            </li>
            <li>
              Now we arrive at our loss objective. The goal is to minimise the
              predicted noise of Van Gogh and maximize the noise of everything
              but Van Gogh.
            </li>
          </ul>
          <p>
            The degree of success attributed to the erasure of a concept depends 
            on the subset of parameters fine-tuned with a main distinction 
            between cross-attention and non-cross-attention parameters. In the 
            paper, ESD-x refers to the process of fine-tuning the cross-attention 
            parameters which is used to perform controlled erasure specific to 
            the prompt. This method has demonstrated impressive results for 
            specific artistic style removal. On the other hand, ESD-u refers to 
            non-cross-attention fine-tuned parameters which tend to contribute to 
            a broader range of visual concepts when the erasure is required to be 
            independent of the text in the prompt which is crucial for the 
            generation of nudity free content. 
          </p>
          <p>
            The experimental study for this solution on its artistic style 
            removal capabilities involved erasing 5 modern artists and conducting 
            a user study to measure the human perception of the effectiveness of 
            the fine-tuned model compared to other approaches. The study showed 
            that ESD-x had superior results demonstrated by its ability to erase 
            the intended style better but also to keep minimum interference with 
            the other styles. The performance of ESD-u-n for removing explicit 
            content was measure against SLD and SD V.20 and showed that the 
            method proposed in this paper outperforms both inference methods 
            and models trained on filtered datasets.
          </p>  
          <div class="row" style="display: table-row;">
            <div class="col justify-content-center text-center" style="display: table-cell; vertical-align: middle;">
              <img
              src="images/ESD_art_performance.png"
              alt="ESD art performance"
              style="width: 400px"
              />
            </div>
            <div class="col justify-content-center text-center" style="display: table-cell; vertical-align: middle;">
              <img
              src="images/ESD_NSFW_performance.png"
              alt="ESD NSFW performance"
              style="width: 700px"
              />
            </div>
          </div>
          <p>
            Erasing an entire object class still involves some limitations 
            represented by a trade-off between complete erasure of a visual 
            concept and interference with other visual concepts. 
          </p>
          <h2>Methods</h2>
          <h2>Results</h2>
          <h2>Conclusion</h2>
        </div>
      </div>
      <div class="row">
        <div class="col">
          <h2>
            Literature Review; Biography; Social Impact; Industry Applications;
            Follow-on Research; and Peer-Review
          </h2>

          <p>
            Just as we have done in the role-playing exercise, analyze the paper
            from all perspectives.
          </p>

          <p>
            Optionally, in addition to a reading-based analysis, implement the
            ideas of the paper in code, and report on your findings.
          </p>

          <h3>References</h3>

          <p>
            <a name="bottou-1990">[1]</a>
            <a href="https://papers.baulab.info/Bottou-1990.pdf"
              >L&eacute;on Bottou and Patrick Gallinari.
              <em
                >A framework for the cooperation of learning algorithms.</em
              ></a
            >
            Advances in neural information processing systems 3 (1990).
          </p>

          <h2>Team Members</h2>

          <p>Ali Alyaqoub, Adam Belfki</p>
        </div>
        <!--col-->
      </div>
      <!--row -->
    </div>
    <!-- container -->

    <footer class="nd-pagefooter">
      <div class="row">
        <div class="col-6 col-md text-center">
          <a href="https://ds4440.baulab.info/2024-Spring/">About DS 4440</a>
        </div>
      </div>
    </footer>
  </body>
  <script>
    $(document).on("click", ".clickselect", function (ev) {
      var range = document.createRange();
      range.selectNodeContents(this);
      var sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
    });
    // Google analytics below.
    window.dataLayer = window.dataLayer || [];
  </script>
</html>
